define("BorderRadiusUtils",["require","exports","module"],function(e,t,n){"use strict";function i(e){var e=/top-left|top-right|bottom-left|bottom-right/.exec(e);return e&&e[0]}var r=new RegExp(".*border-radius:.*|.*border-top-left-radius:.*|.*border-top-right-radius:.*|.*border-bottom-left-radius:.*|.*border-bottom-right-radius:.*"),o=new RegExp(/((\d+\.?\d*)(px|em|%)?){1,4}.*/),a=new RegExp(/(\d+\.?\d*)(px|em|%)?/,"g");t.BORDER_RADIUS_REGEX=r,t.BORDER_RADIUS_VALUE_REGEX=o,t.BORDER_RADIUS_SINGLE_VALUE_REGEX=a,t.getSingleProperty=i}),define("text",["module"],function(e){"use strict";var t,n,i,r,o,a=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],s=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,d=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,l="undefined"!=typeof location&&location.href,u=l&&location.protocol&&location.protocol.replace(/\:/,""),c=l&&location.hostname,h=l&&(location.port||void 0),p={},f=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(s,"");var t=e.match(d);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:f.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=a[t];try{e=new ActiveXObject(n)}catch(i){}if(e){a=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.indexOf("."),a=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!a||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,a,s,d=t.xdRegExp.exec(e);return d?(o=d[2],a=d[3],a=a.split(":"),s=a[1],a=a[0],!(o&&o!==n||a&&a.toLowerCase()!==i.toLowerCase()||(s||a)&&s!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,f.isBuild&&(p[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();f.isBuild=r.isBuild;var o=t.parseName(e),a=o.moduleName+(o.ext?"."+o.ext:""),s=n.toUrl(a),d=f.useXhr||t.useXhr;return 0===s.indexOf("empty:")?void i():void(!l||d(s,u,c,h)?t.get(s,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([a],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,n,i,r){if(p.hasOwnProperty(n)){var o=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var a=t.parseName(n),s=a.ext?"."+a.ext:"",d=a.moduleName+s,l=i.toUrl(a.moduleName+s)+".js";t.load(d,i,function(n){var i=function(e){return r(l,e)};i.asModule=function(e,t){return r.asModule(e,l,t)},t.write(e,d,i,o)},o)}},"node"===f.env||!f.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(o){i(o)}}):"xhr"===f.env||!f.env&&t.createXhr()?t.get=function(e,n,i,r){var o,a=t.createXhr();if(a.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&a.setRequestHeader(o.toLowerCase(),r[o]);f.onXhr&&f.onXhr(a,e),a.onreadystatechange=function(t){var r,o;4===a.readyState&&(r=a.status,r>399&&600>r?(o=new Error(e+" HTTP status: "+r),o.xhr=a,i(o)):n(a.responseText),f.onXhrComplete&&f.onXhrComplete(a,e))},a.send(null)}:"rhino"===f.env||!f.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),a=java.lang.System.getProperty("line.separator"),s=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),d="";try{for(n=new java.lang.StringBuffer,i=s.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=s.readLine());)n.append(a),n.append(i);d=String(n.toString())}finally{s.close()}t(d)}:("xpconnect"===f.env||!f.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,a,s,d={};o&&(e=e.replace(/\//g,"\\")),s=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(s,1,0,!1),a=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),a.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),a.readString(n.available(),d),a.close(),n.close(),t(d.value)}catch(l){throw new Error((s&&s.path||"")+": "+l)}}),t}),define("text!BorderRadiusEditorTemplate.html",[],function(){return'<div tabindex="-1" class="border-radius-editor">\n {{#inlineEditorHeader}}\n    <header>\n        <ul class="button-bar">\n          <li id="allCorners" title="{{ALL_CORNERS}}">\n              <a href="#" tabindex="0">{{ALL_CORNERS}}</a>\n          </li>\n          <li title="{{INDIVIDUAL_CORNERS}}" id="individualCorners">\n              <a href="#" tabindex="0">{{INDIVIDUAL_CORNERS}}</a>\n          </li>\n        </ul>\n    </header>\n {{/inlineEditorHeader}}\n\n {{#individualCornerArea}}\n    <div id="individualCornerArea">\n\n        <table>\n            <tr class="border-radius-input">\n                <td class="label-container">\n                    <div class="top-left corner-icon"></div>\n                </td>\n                <td class="slider-container">\n                   <input id="top-left-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td class="slider-value">\n                   <span class="slider-indicator" id="top-left-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-padding-left" id="top-left-radio">\n                        <li id="top-left-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" id="top-left-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" id="top-left-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n\n            <tr class="border-radius-input">\n                <td class="label-container">\n                    <div class="top-right corner-icon"></div>\n                </td>\n                <td class="slider-container">\n                    <input id="top-right-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                    <span class="slider-indicator" id="top-right-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-padding-left" id="top-right-radio">\n                        <li id="top-right-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" id="top-right-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" id="top-right-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n\n            <tr class="border-radius-input">\n                <td class="label-container">\n                    <div class="bottom-right corner-icon"></div>\n                </td>\n                <td class="slider-container">\n                   <input id="bottom-right-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                   <span class="slider-indicator" id="bottom-right-text"></span>\n                </td>\n                <td class="units-container">\n                   <ul class="button-bar ul-padding-left" id="bottom-right-radio">\n                       <li id="bottom-right-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                       <li title="{{PERCENTAGE_UNIT}}" id="bottom-right-radio-percent"><a href="#" tabindex="0">%</a></li>\n                       <li title="{{EM_UNIT}}" id="bottom-right-radio-em"><a href="#" tabindex="0">em</a></li>\n                   </ul>\n                </td>\n            </tr>\n\n            <tr class="border-radius-input">\n                <td class="label-container">\n                    <div class="bottom-left corner-icon"></div>\n                </td>\n                <td class="slider-container">\n                    <input id="bottom-left-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                    <span class="slider-indicator" id="bottom-left-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-padding-left" id="bottom-left-radio">\n                        <li id="bottom-left-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" id="bottom-left-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" id="bottom-left-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n        </table>\n    </div>\n {{/individualCornerArea}}\n    \n \n    <div id="allCornersArea">\n       <table>\n           <tr class="border-radius-input">\n               <td class="label-container">\n               {{#allCornerArea}}\n                   <div class="all corner-icon">\n                       <div class="dot"></div>\n                       <div class="dot"></div>\n                       <div class="dot"></div>\n                       <div class="dot"></div>\n                   </div>\n                {{/allCornerArea}} \n                {{#singleCornerArea}}\n                    <div class="{{iconClassName}} corner-icon"></div>\n                 {{/singleCornerArea}} \n               </td>\n               <td class="slider-container">\n                   <input id="all-corner-slider" type="range" min="0" max="100" step="1">\n               </td>\n               <td class="slider-value">\n                  <span class="slider-indicator" id="all-corner-text"></span>\n               </td>\n               <td class="units-container">\n                    <ul class="button-bar ul-padding-left" id="all-corner-radio">\n                        <li id="all-corner-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" id="all-corner-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" id="all-corner-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n               </td>\n           </tr>\n       </table>\n    </div> \n</div>\n'}),define("BorderRadiusEditor",["require","exports","module","BorderRadiusUtils","text!BorderRadiusEditorTemplate.html"],function(e,t,n){"use strict";function i(e){for(var t,n=[],i=new RegExp(d.BORDER_RADIUS_SINGLE_VALUE_REGEX);null!==(t=i.exec(e));)n.push({num:parseFloat(t[1]),unit:t[2]||""});return n}function r(e,t,n,i,r){var o=this;o.value=n||0,o.unit=i||"";var a=this.$slider=e.find("#"+t+"-slider"),s=e.find("#"+t+"-radio").children(),d=e.find("#"+t+"-text");a.val(o.value),s.filter(function(){return $(this).text().trim()===o.unit}).addClass("selected"),d.text(o.toString()),a.on("input",function(){var e=a.val().trim();o.value=e,d.text(o.toString()),r()}),s.on("click",function(){var e=$(this);e.siblings().removeClass("selected"),e.addClass("selected"),o.unit=e.text().trim(),d.text(o.toString()),r()})}function o(e,t,n,i,r){function o(e,t){e.show(),t.hide(),d.allCorners=e===p,d.onChange()}var d=this,u=JSON.parse(JSON.stringify(a));r?u.singleCornerArea=!0:(u.inlineEditorHeader=!0,u.individualCornerArea=!0,u.allCornerArea=!0),u.iconClassName=i,d.$element=$(s.render(l,u)),e.append(d.$element),d.radiusChangeHandler=n,this.onChange=this.onChange.bind(this),d.updateValues(t);var c=d.$element.find("#individualCornerArea"),h=d.$element.find("#individualCorners"),p=d.$element.find("#allCornersArea"),f=d.$element.find("#allCorners");f.on("click",function(){f.addClass("selected"),h.removeClass("selected"),o(p,c)}),h.on("click",function(){f.removeClass("selected"),h.addClass("selected"),o(c,p)}),d.allCorners?f.trigger("click"):h.trigger("click")}var a=brackets.getModule("strings"),s=brackets.getModule("thirdparty/mustache/mustache"),d=e("BorderRadiusUtils"),l=e("text!BorderRadiusEditorTemplate.html");r.prototype.toString=function(){return this.value+(0===this.value?"":this.unit)},o.prototype.updateValues=function(e){var t=i(e),n=t.length,o=t[0],a=o,s=o,d=o;this.allCorners=1===t.length,this.allCorners||(a=t[1],2===n?d=a:(s=t[2],d=3===n?a:t[3])),this.topLeft=new r(this.$element,"top-left",o.num,o.unit,this.onChange),this.topRight=new r(this.$element,"top-right",a.num,a.unit,this.onChange),this.bottomRight=new r(this.$element,"bottom-right",s.num,s.unit,this.onChange),this.bottomLeft=new r(this.$element,"bottom-left",d.num,d.unit,this.onChange),this.allCorner=new r(this.$element,"all-corner",o.num,o.unit,this.onChange),this.onChange()},o.prototype.onChange=function(){if(this.allCorners)return void this.radiusChangeHandler(this.allCorner.toString());var e,t=this.topLeft.toString(),n=this.topRight.toString(),i=this.bottomRight.toString(),r=this.bottomLeft.toString();n===r?(e=t+" "+n,t!==i?e+=" "+i:t===n&&(e=t)):e=[t,n,i,r].join(" "),this.radiusChangeHandler(e)},o.prototype.focus=function(){this.topLeft.$slider.focus()},o.prototype.isValidBorderRadiusString=function(e){var t=new RegExp(d.BORDER_RADIUS_VALUE_REGEX);return t.test(e)},t.BorderRadiusEditor=o}),define("InlineBorderRadiusEditor",["require","exports","module","BorderRadiusUtils","BorderRadiusEditor"],function(e,t,n){"use strict";function i(e,t,n,i){this._borderRadius=e,this._marker=t,this._isOwnChange=!1,this._isHostChange=!1,this._origin="+InlineBorderRadiusEditor_"+s++,this.cssClassSuffix=n,this.isSingleProperty=i,this._handleBorderRadiusChange=this._handleBorderRadiusChange.bind(this),this._handleHostDocumentChange=this._handleHostDocumentChange.bind(this),r.call(this)}var r=brackets.getModule("editor/InlineWidget").InlineWidget,o=e("BorderRadiusUtils"),a=e("BorderRadiusEditor").BorderRadiusEditor,s=1;i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.parentClass=r.prototype,i.prototype.borderRaidusEditor=null,i.prototype._marker=null,i.prototype._isOwnChange=null,i.prototype._isHostChange=null,i.prototype._origin=null,i.prototype.getCurrentRange=function(){var e,t,n;if(e=this._marker&&this._marker.find(),t=e&&e.from,!t)return null;n=e.to,n||(n={line:t.line});for(var i=this.hostEditor.document.getLine(t.line),r=i.indexOf(":")+1;r<i.length;r++)if(" "!==i[r]){t.ch=r;break}var a=i.substr(t).match(o.BORDER_RADIUS_VALUE_REGEX);return a&&(void 0===n.ch||n.ch-t.ch<a[0].length)&&(n.ch=t.ch+a[0].length,this._marker.clear(),this._marker=this.hostEditor._codeMirror.markText(t,n)),void 0===n.ch?null:{start:t,end:n}},i.prototype._handleBorderRadiusChange=function(e){var t=this;if(e.replace(";","")!==this._borderRadius){var n=this.getCurrentRange();if(!n)return;if(!this._isHostChange){var i={line:n.start.line,ch:n.start.ch+e.length};this._isOwnChange=!0,this.hostEditor.document.batchOperation(function(){n.end.ch-=1,t.hostEditor.setSelection(n.start,n.end),t.hostEditor.document.replaceRange(e,n.start,n.end,t._origin),t._marker&&(t._marker.clear(),t._marker=t.hostEditor._codeMirror.markText(n.start,i))}),this._isOwnChange=!1}this._borderRadius=e.replace(";","")}},i.prototype.load=function(e){i.prototype.parentClass.load.apply(this,arguments),this.borderRadiusEditor=new a(this.$htmlContent,this._borderRadius,this._handleBorderRadiusChange,this.cssClassSuffix,this.isSingleProperty)},i.prototype.onAdded=function(){i.prototype.parentClass.onAdded.apply(this,arguments);var e=this.hostEditor.document;e.addRef(),e.on("change",this._handleHostDocumentChange),this.hostEditor.setInlineWidgetHeight(this,this.borderRadiusEditor.$element.outerHeight()+50,!0),this.borderRadiusEditor.focus()},i.prototype.onClosed=function(){i.prototype.parentClass.onClosed.apply(this,arguments),this._marker&&this._marker.clear();var e=this.hostEditor.document;e.off("change",this._handleHostDocumentChange),e.releaseRef()},i.prototype._handleHostDocumentChange=function(){if(!this._isOwnChange){var e=this.getCurrentRange();if(e){var t=this.hostEditor.document.getRange(e.start,e.end);t!==this._borderRadius&&this.borderRadiusEditor.isValidBorderRadiusString(t)&&(this._isHostChange=!0,this.borderRadiusEditor.updateValues(t),this._isHostChange=!1)}else this.close()}},t.InlineBorderRadiusEditor=i}),define("text!BorderRadiusProperties.json",[],function(){return'{\n    "border-radius": {"values": ["inherit"]},\n    "border-top-left-radius": {"values": ["inherit"]},\n    "border-top-right-radius": {"values": ["inherit"]},\n    "border-bottom-left-radius": {"values": ["inherit"]},\n    "border-bottom-right-radius": {"values": ["inherit"]}\n}\n'}),define("main",["require","exports","module","InlineBorderRadiusEditor","text!BorderRadiusProperties.json","BorderRadiusUtils"],function(e,t,n){"use strict";function i(e,t){var n,i,r,o,a,s,d,h,p;if(a=e.getSelection(),a.start.line!==a.end.line)return null;n=new RegExp(u.BORDER_RADIUS_REGEX),i=new RegExp(u.BORDER_RADIUS_VALUE_REGEX),r=e.document.getLine(t.line);do{o=n.exec(r),o&&(s=o.index,d=s+o[0].length)}while(o&&(t.ch<s||t.ch>d));if(o){var f,g,m,v,b,E,R,x;if(f=r.split(":")[0].trim(),!f||!l[f])return null;if(x=u.getSingleProperty(f),R=!!x,l[f]){if(m=r.indexOf(":"),g=r.indexOf(";"),b=r.substring(m+1,r.length),v=b.replace(/ /g,"").replace(";","")){if(!i.test(v))return null;E=b.search(/\S/),t.ch=m+1+Math.min(E,1),h=-1!==g?{line:t.line,ch:g}:{line:t.line,ch:r.length}}else{var C,_,y=" ";y=y.concat(c,";"),C={line:t.line,ch:m+1},_={line:t.line,ch:r.length},e._codeMirror.replaceRange(y,C,_),t.ch=m+2,h={line:t.line,ch:t.ch+c.length},v=c}return p=e._codeMirror.markText(t,h),e.setSelection(t,h),{radius:v,marker:p,cssClassSuffix:x,isSingleProperty:R}}}return null}function r(e,t){var n,r,o=i(e,t);return o?(n=new d(o.radius,o.marker,o.cssClassSuffix,o.isSingleProperty),n.load(e),r=new $.Deferred,r.resolve(n),r.promise()):null}function o(e,t){var n,i,r,o,a,s,d,c,h,p,f;if(o=e.getSelection(),o.start.line!==o.end.line)return!1;n=new RegExp(u.BORDER_RADIUS_REGEX),i=e.document.getLine(t.line);do{r=n.exec(i),r&&(a=r.index,s=a+r[0].length)}while(r&&(t.ch<a||t.ch>s));return r?!0:(d=i.split(":")[0].trim(),d&&l[d]&&l[d]?(h=i.indexOf(":"),c=i.indexOf(";"),f=i.substring(h+1,i.length),p=f.replace(/ /g,"").replace(";",""),p?n.test(p):!0):!1)}var a=brackets.getModule("editor/EditorManager"),s=brackets.getModule("utils/ExtensionUtils"),d=e("InlineBorderRadiusEditor").InlineBorderRadiusEditor,l=JSON.parse(e("text!BorderRadiusProperties.json")),u=e("BorderRadiusUtils"),c="15px";s.loadStyleSheet(n,"css/main.less"),a.registerInlineEditProvider(r,o),t.prepareEditorForProvider=i});