define("BoxModelUtils",["require","exports","module"],function(e,t,n){"use strict";var i=new RegExp("(.*padding:.*|.*margin:.*)"),r=new RegExp(/((\d+\.?\d*)(px|em|%)?){1,4}.*/),o=new RegExp(/(\d+\.?\d*)(px|em|%)?/,"g"),l="margin",a="padding";t.BOXMODEL_REGEX=i,t.BOXMODEL_VALUE_REGEX=r,t.BOXMODEL_SINGLE_VALUE_REGEX=o,t.MARGIN=l,t.PADDING=a}),define("text",["module"],function(e){"use strict";var t,n,i,r,o,l=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],a=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,s=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,d="undefined"!=typeof location&&location.href,c=d&&location.protocol&&location.protocol.replace(/\:/,""),u=d&&location.hostname,h=d&&(location.port||void 0),p={},g=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(a,"");var t=e.match(s);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:g.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=l[t];try{e=new ActiveXObject(n)}catch(i){}if(e){l=[n];break}}return e},parseName:function(e){var t,n,i,r=!1,o=e.indexOf("."),l=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!l||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,i=n||t,o=i.indexOf("!"),-1!==o&&(r="strip"===i.substring(o+1),i=i.substring(0,o),n?n=i:t=i),{moduleName:t,ext:n,strip:r}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,i,r){var o,l,a,s=t.xdRegExp.exec(e);return s?(o=s[2],l=s[3],l=l.split(":"),a=l[1],l=l[0],!(o&&o!==n||l&&l.toLowerCase()!==i.toLowerCase()||(a||l)&&a!==r)):!0},finishLoad:function(e,n,i,r){i=n?t.strip(i):i,g.isBuild&&(p[e]=i),r(i)},load:function(e,n,i,r){if(r.isBuild&&!r.inlineText)return void i();g.isBuild=r.isBuild;var o=t.parseName(e),l=o.moduleName+(o.ext?"."+o.ext:""),a=n.toUrl(l),s=g.useXhr||t.useXhr;return 0===a.indexOf("empty:")?void i():void(!d||s(a,c,u,h)?t.get(a,function(n){t.finishLoad(e,o.strip,n,i)},function(e){i.error&&i.error(e)}):n([l],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,i)}))},write:function(e,n,i,r){if(p.hasOwnProperty(n)){var o=t.jsEscape(p[n]);i.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,i,r,o){var l=t.parseName(n),a=l.ext?"."+l.ext:"",s=l.moduleName+a,d=i.toUrl(l.moduleName+a)+".js";t.load(s,i,function(n){var i=function(e){return r(d,e)};i.asModule=function(e,t){return r.asModule(e,d,t)},t.write(e,s,i,o)},o)}},"node"===g.env||!g.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,i){try{var r=n.readFileSync(e,"utf8");0===r.indexOf("\ufeff")&&(r=r.substring(1)),t(r)}catch(o){i(o)}}):"xhr"===g.env||!g.env&&t.createXhr()?t.get=function(e,n,i,r){var o,l=t.createXhr();if(l.open("GET",e,!0),r)for(o in r)r.hasOwnProperty(o)&&l.setRequestHeader(o.toLowerCase(),r[o]);g.onXhr&&g.onXhr(l,e),l.onreadystatechange=function(t){var r,o;4===l.readyState&&(r=l.status,r>399&&600>r?(o=new Error(e+" HTTP status: "+r),o.xhr=l,i(o)):n(l.responseText),g.onXhrComplete&&g.onXhrComplete(l,e))},l.send(null)}:"rhino"===g.env||!g.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,i,r="utf-8",o=new java.io.File(e),l=java.lang.System.getProperty("line.separator"),a=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),r)),s="";try{for(n=new java.lang.StringBuffer,i=a.readLine(),i&&i.length()&&65279===i.charAt(0)&&(i=i.substring(1)),null!==i&&n.append(i);null!==(i=a.readLine());)n.append(l),n.append(i);s=String(n.toString())}finally{a.close()}t(s)}:("xpconnect"===g.env||!g.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(i=Components.classes,r=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in i,t.get=function(e,t){var n,l,a,s={};o&&(e=e.replace(/\//g,"\\")),a=new FileUtils.File(e);try{n=i["@mozilla.org/network/file-input-stream;1"].createInstance(r.nsIFileInputStream),n.init(a,1,0,!1),l=i["@mozilla.org/intl/converter-input-stream;1"].createInstance(r.nsIConverterInputStream),l.init(n,"utf-8",n.available(),r.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),l.readString(n.available(),s),l.close(),n.close(),t(s.value)}catch(d){throw new Error((a&&a.path||"")+": "+d)}}),t}),define("text!BoxModelEditorTemplate.html",[],function(){return'<div tabindex="-1" class="boxmodel-editor">\n    <header>\n        <label>{{BOX_MODEL_HEADER}}</label>\n        <ul class="button-bar">\n          <li id="allSides" title="{{ALL_SIDES}}">\n              <a href="#" tabindex="0">{{ALL_SIDES}}</a>\n          </li>\n          <li title="{{INDIVIDUAL_SIDES}}" disabled="true" id="individualSides">\n              <a href="#" tabindex="0">{{INDIVIDUAL_SIDES}}</a>\n          </li>\n        </ul>\n    </header>\n\n    <div id="individualSidesArea">\n\n        <table>\n            <tr class="boxmodel-input">\n                <td class="label-container">\n                    <div class="top {{box-model-icon-class-name}}"></div>\n                    \x3c!-- Top left --\x3e\n                </td>\n                <td class="slider-container">\n                   <input id="top-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td class="slider-value">\n                   <span class="slider-indicator" id="top-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-boxmodel-left" id="top-radio">\n                        <li id="top-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" disabled="true" id="top-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" disabled="true" id="top-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n\n            <tr class="boxmodel-input">\n                <td class="label-container">\n                    <div class="right {{box-model-icon-class-name}}"></div>\n                    \x3c!-- Top right --\x3e\n                </td>\n                <td class="slider-container">\n                    <input id="right-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                    <span class="slider-indicator" id="right-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-boxmodel-left" id="right-radio">\n                        <li id="right-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" disabled="true" id="right-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" disabled="true" id="right-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n\n            <tr class="boxmodel-input">\n                <td class="label-container">\n                    <div class="bottom {{box-model-icon-class-name}}"></div>\n                    \x3c!-- Bottom right --\x3e\n                </td>\n                <td class="slider-container">\n                   <input id="bottom-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                   <span class="slider-indicator" id="bottom-text"></span>\n                </td>\n                <td class="units-container">\n                   <ul class="button-bar ul-boxmodel-left" id="bottom-radio">\n                       <li id="bottom-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                       <li title="{{PERCENTAGE_UNIT}}" disabled="true" id="bottom-radio-percent"><a href="#" tabindex="0">%</a></li>\n                       <li title="{{EM_UNIT}}" disabled="true" id="bottom-radio-em"><a href="#" tabindex="0">em</a></li>\n                   </ul>\n                </td>\n            </tr>\n\n            <tr class="boxmodel-input">\n                <td class="label-container">\n                    <div class="left {{box-model-icon-class-name}}"></div>\n                    \x3c!-- Bottom left --\x3e\n                </td>\n                <td class="slider-container">\n                    <input id="left-slider" type="range" min="0" max="100" step="1">\n                </td>\n                <td>\n                    <span class="slider-indicator" id="left-text"></span>\n                </td>\n                <td class="units-container">\n                    <ul class="button-bar ul-boxmodel-left" id="left-radio">\n                        <li id="left-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" disabled="true" id="left-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" disabled="true" id="left-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n                </td>\n            </tr>\n        </table>\n    </div>\n\n    <div id="allSidesArea">\n       <table>\n           <tr class="boxmodel-input">\n               <td class="label-container">All sides</td>\n               <td class="slider-container">\n                   <input id="all-sides-slider" type="range" min="0" max="100" step="1">\n               </td>\n               <td class="slider-value">\n                  <span class="slider-indicator" id="all-sides-text"></span>\n               </td>\n               <td class="units-container">\n                    <ul class="button-bar ul-boxmodel-left" id="all-sides-radio">\n                        <li id="all-sides-radio-px" title="{{PIXEL_UNIT}}"><a href="#" tabindex="0">px</a></li>\n                        <li title="{{PERCENTAGE_UNIT}}" disabled="true" id="all-sides-radio-percent"><a href="#" tabindex="0">%</a></li>\n                        <li title="{{EM_UNIT}}" disabled="true" id="all-sides-radio-em"><a href="#" tabindex="0">em</a></li>\n                    </ul>\n               </td>\n           </tr>\n       </table>\n    <div>\n</div>\n\n'}),define("BoxModelEditor",["require","exports","module","BoxModelUtils","text!BoxModelEditorTemplate.html"],function(e,t,n){"use strict";function i(e){for(var t,n=[],i=new RegExp(d.BOXMODEL_SINGLE_VALUE_REGEX);null!==(t=i.exec(e));)n.push({num:parseFloat(t[1]),unit:t[2]||""});return n}function r(e,t,n,i,r){var o=this;o.value=n||0,o.unit=i||"";var l=this.$slider=e.find("#"+t+"-slider"),a=e.find("#"+t+"-radio").children(),s=e.find("#"+t+"-text");l.val(o.value),a.filter(function(){return $(this).text().trim()===o.unit}).addClass("selected"),s.text(o.toString()),l.on("input",function(){var e=l.val().trim();o.value=e,s.text(o.toString()),r()}),a.on("click",function(){var e=$(this);e.siblings().removeClass("selected"),e.addClass("selected"),o.unit=e.text().trim(),s.text(o.toString()),r()})}function o(e,t,n,i,r){function o(e,t){e.show(),t.hide(),u.allSides=e===f,l=e===f,u.onChange()}var u=this,h="";switch(i){case d.PADDING:h="SET_PADDING_FOR";break;case d.MARGIN:h="SET_MARGIN_FOR"}a.BOX_MODEL_HEADER=a[h],a["box-model-icon-class-name"]=r,u.$element=$(s.render(c,a)),e.append(u.$element),u.BoxModelChangeHandler=n,this.onChange=this.onChange.bind(this),u.updateValues(t);var p=u.$element.find("#individualSidesArea"),g=u.$element.find("#individualSides"),f=u.$element.find("#allSidesArea"),m=u.$element.find("#allSides");m.on("click",function(){m.addClass("selected"),g.removeClass("selected"),o(f,p)}),g.on("click",function(){m.removeClass("selected"),g.addClass("selected"),o(p,f)}),u.allSides?m.trigger("click"):g.trigger("click")}var l,a=brackets.getModule("strings"),s=brackets.getModule("thirdparty/mustache/mustache"),d=e("BoxModelUtils"),c=(brackets.getModule("utils/KeyEvent"),brackets.getModule("preferences/PreferencesManager"),brackets.getModule("utils/StringUtils"),e("text!BoxModelEditorTemplate.html"));r.prototype.toString=function(){return this.value+(0===this.value?"":this.unit)},o.prototype.updateValues=function(e){var t=i(e),n=t.length;this.allSides=1===t.length;var o=t[0],l=o,a=o,s=o;this.allSides||(l=t[1],2===n?s=l:(a=t[2],s=3===n?l:t[3])),this.top=new r(this.$element,"top",o.num,o.unit,this.onChange),this.right=new r(this.$element,"right",l.num,l.unit,this.onChange),this.bottom=new r(this.$element,"bottom",a.num,a.unit,this.onChange),this.left=new r(this.$element,"left",s.num,s.unit,this.onChange),this.allsides=new r(this.$element,"all-sides",o.num,o.unit,this.onChange),this.onChange()},o.prototype.onChange=function(){if(this.allSides)return void this.BoxModelChangeHandler(this.allsides.toString());var e,t=this.top.toString(),n=this.right.toString(),i=this.bottom.toString(),r=this.left.toString();e=[t,n,i,r].join(" "),this.BoxModelChangeHandler(e)},o.prototype.focus=function(){this.top.$slider.focus()},o.prototype.isValidBoxModelString=function(e){var t=new RegExp(d.BOXMODEL_VALUE_REGEX);return t.test(e)},t.BoxModelEditor=o}),define("text!BoxModelProperties.json",[],function(){return'{\n    "padding": {"values": ["inherit"]},\n    "padding-top": {"values": ["inherit"]},\n    "padding-right": {"values": ["inherit"]},\n    "padding-bottom": {"values": ["inherit"]},\n    "padding-left": {"values": ["inherit"]},\n    "margin": {"values": ["inherit"]},\n    "margin-top": {"values": ["inherit"]},\n    "margin-right": {"values": ["inherit"]},\n    "margin-bottom": {"values": ["inherit"]},\n    "margin-left": {"values": ["inherit"]}\n}\n\n'}),define("InlineBoxModelEditor",["require","exports","module","BoxModelUtils","BoxModelEditor","text!BoxModelProperties.json"],function(e,t,n){"use strict";function i(e,t,n,i){this._BoxModel=e,this._marker=t,this._isOwnChange=!1,this._isHostChange=!1,this._origin="+InlineBoxModelEditor_"+a++,this.type=n,this.iconClassName=i,this._handleBoxModelChange=this._handleBoxModelChange.bind(this),this._handleHostDocumentChange=this._handleHostDocumentChange.bind(this),r.call(this)}var r=brackets.getModule("editor/InlineWidget").InlineWidget,o=e("BoxModelUtils"),l=e("BoxModelEditor").BoxModelEditor,a=(brackets.getModule("editor/EditorManager"),brackets.getModule("utils/ExtensionUtils"),JSON.parse(e("text!BoxModelProperties.json")),1);i.prototype=Object.create(r.prototype),i.prototype.constructor=i,i.prototype.parentClass=r.prototype,i.prototype.BoxModelEditor=null,i.prototype._marker=null,i.prototype._isOwnChange=null,i.prototype._isHostChange=null,i.prototype._origin=null,i.prototype.getCurrentRange=function(){var e,t,n;if(e=this._marker&&this._marker.find(),t=e&&e.from,!t)return null;n=e.to,n||(n={line:t.line});for(var i=this.hostEditor.document.getLine(t.line),r=i.indexOf(":")+1;r<i.length;r++)if(" "!==i[r]){t.ch=r;break}var l=i.substr(t).match(o.BOXMODEL_VALUE_REGEX);return l&&(void 0===n.ch||n.ch-t.ch<l[0].length)&&(n.ch=t.ch+l[0].length,this._marker.clear(),this._marker=this.hostEditor._codeMirror.markText(t,n)),void 0===n.ch?null:{start:t,end:n}},i.prototype._handleBoxModelChange=function(e){var t=this;if(e.replace(";","")!==this._BoxModel){var n=this.getCurrentRange();if(!n)return;if(!this._isHostChange){var i={line:n.start.line,ch:n.start.ch+e.length};this._isOwnChange=!0,this.hostEditor.document.batchOperation(function(){n.end.ch-=1,t.hostEditor.setSelection(n.start,n.end),t.hostEditor.document.replaceRange(e,n.start,n.end,t._origin),t._marker&&(t._marker.clear(),t._marker=t.hostEditor._codeMirror.markText(n.start,i))}),this._isOwnChange=!1}this._BoxModel=e.replace(";","")}},i.prototype.load=function(e){i.prototype.parentClass.load.apply(this,arguments),this.BoxModelEditor=new l(this.$htmlContent,this._BoxModel,this._handleBoxModelChange,this.type,this.iconClassName)},i.prototype.onAdded=function(){i.prototype.parentClass.onAdded.apply(this,arguments);var e=this.hostEditor.document;e.addRef(),e.on("change",this._handleHostDocumentChange),this.hostEditor.setInlineWidgetHeight(this,this.BoxModelEditor.$element.outerHeight()+50,!0),this.BoxModelEditor.focus()},i.prototype.onClosed=function(){i.prototype.parentClass.onClosed.apply(this,arguments),this._marker&&this._marker.clear();var e=this.hostEditor.document;e.off("change",this._handleHostDocumentChange),e.releaseRef()},i.prototype._handleHostDocumentChange=function(){if(!this._isOwnChange){var e=this.getCurrentRange();if(e){var t=this.hostEditor.document.getRange(e.start,e.end);t!==this._BoxModel&&this.BoxModelEditor.isValidBoxModelString(t)&&(this._isHostChange=!0,this.BoxModelEditor.updateValues(t),this._isHostChange=!1)}else this.close()}},t.InlineBoxModelEditor=i}),define("main",["require","exports","module","InlineBoxModelEditor","text!BoxModelProperties.json","BoxModelUtils"],function(e,t,n){"use strict";function i(e,t){var n,i,r,o,l,a,s,h,p;if(l=e.getSelection(),l.start.line!==l.end.line)return null;n=new RegExp(c.BOXMODEL_REGEX),i=new RegExp(c.BOXMODEL_VALUE_REGEX),r=e.document.getLine(t.line);do{o=n.exec(r),o&&(a=o.index,s=a+o[0].length)}while(o&&(t.ch<a||t.ch>s));if(o){var g,f,m,x,E,v,b,M;if(f=r.split(":")[0].trim(),"margin"===f?(g="margin",M="margin-side-icon"):(g="padding",M="side-icon"),!f||!d[f])return null;if(d[f]){if(x=r.indexOf(":"),m=r.indexOf(";"),v=r.substring(x+1,r.length),E=v.replace(/ /g,"").replace(";","")){if(!i.test(E))return null;b=v.search(/\S/),t.ch=x+1+Math.min(b,1),h=-1!==m?{line:t.line,ch:m}:{line:t.line,ch:r.length}}else{var _,C,B=" ";B=B.concat(u,";"),_={line:t.line,ch:x+1},C={line:t.line,ch:r.length},e._codeMirror.replaceRange(B,_,C),t.ch=x+2,h={line:t.line,ch:t.ch+u.length},E=u}return p=e._codeMirror.markText(t,h),e.setSelection(t,h),{BoxModel:E,marker:p,type:g,iconClassName:M}}}return null}function r(e,t){var n,r,o=i(e,t);return o?(n=new s(o.BoxModel,o.marker,o.type,o.iconClassName),n.load(e),r=new $.Deferred,r.resolve(n),r.promise()):null}function o(e,t){var n,i,r,o,l,a,s,u,h,p,g;if(o=e.getSelection(),o.start.line!==o.end.line)return!1;n=new RegExp(c.BOXMODEL_REGEX),i=e.document.getLine(t.line);do{r=n.exec(i),r&&(l=r.index,a=l+r[0].length)}while(r&&(t.ch<l||t.ch>a));return r?!0:(s=i.split(":")[0].trim(),s&&d[s]&&d[s]?(h=i.indexOf(":"),u=i.indexOf(";"),g=i.substring(h+1,i.length),p=g.replace(/ /g,"").replace(";",""),p?n.test(p):!0):!1)}var l=brackets.getModule("editor/EditorManager"),a=brackets.getModule("utils/ExtensionUtils"),s=e("InlineBoxModelEditor").InlineBoxModelEditor,d=JSON.parse(e("text!BoxModelProperties.json")),c=e("BoxModelUtils"),u=(brackets.getModule("editor/InlineWidget").InlineWidget,"15px");a.loadStyleSheet(n,"css/main.less"),l.registerInlineEditProvider(r,o),t.prepareEditorForProvider=i,t.inlineBoxModelProvider=r});