define("text",["module"],function(e){"use strict";var t,n,r,a,o,s=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],i=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,l=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,c="undefined"!=typeof location&&location.href,u=c&&location.protocol&&location.protocol.replace(/\:/,""),d=c&&location.hostname,p=c&&(location.port||void 0),f={},m=e.config&&e.config()||{};return t={version:"2.0.10",strip:function(e){if(e){e=e.replace(i,"");var t=e.match(l);t&&(e=t[1])}else e="";return e},jsEscape:function(e){return e.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:m.createXhr||function(){var e,t,n;if("undefined"!=typeof XMLHttpRequest)return new XMLHttpRequest;if("undefined"!=typeof ActiveXObject)for(t=0;3>t;t+=1){n=s[t];try{e=new ActiveXObject(n)}catch(r){}if(e){s=[n];break}}return e},parseName:function(e){var t,n,r,a=!1,o=e.indexOf("."),s=0===e.indexOf("./")||0===e.indexOf("../");return-1!==o&&(!s||o>1)?(t=e.substring(0,o),n=e.substring(o+1,e.length)):t=e,r=n||t,o=r.indexOf("!"),-1!==o&&(a="strip"===r.substring(o+1),r=r.substring(0,o),n?n=r:t=r),{moduleName:t,ext:n,strip:a}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(e,n,r,a){var o,s,i,l=t.xdRegExp.exec(e);return l?(o=l[2],s=l[3],s=s.split(":"),i=s[1],s=s[0],!(o&&o!==n||s&&s.toLowerCase()!==r.toLowerCase()||(i||s)&&i!==a)):!0},finishLoad:function(e,n,r,a){r=n?t.strip(r):r,m.isBuild&&(f[e]=r),a(r)},load:function(e,n,r,a){if(a.isBuild&&!a.inlineText)return void r();m.isBuild=a.isBuild;var o=t.parseName(e),s=o.moduleName+(o.ext?"."+o.ext:""),i=n.toUrl(s),l=m.useXhr||t.useXhr;return 0===i.indexOf("empty:")?void r():void(!c||l(i,u,d,p)?t.get(i,function(n){t.finishLoad(e,o.strip,n,r)},function(e){r.error&&r.error(e)}):n([s],function(e){t.finishLoad(o.moduleName+"."+o.ext,o.strip,e,r)}))},write:function(e,n,r,a){if(f.hasOwnProperty(n)){var o=t.jsEscape(f[n]);r.asModule(e+"!"+n,"define(function () { return '"+o+"';});\n")}},writeFile:function(e,n,r,a,o){var s=t.parseName(n),i=s.ext?"."+s.ext:"",l=s.moduleName+i,c=r.toUrl(s.moduleName+i)+".js";t.load(l,r,function(n){var r=function(e){return a(c,e)};r.asModule=function(e,t){return a.asModule(e,c,t)},t.write(e,l,r,o)},o)}},"node"===m.env||!m.env&&"undefined"!=typeof process&&process.versions&&process.versions.node&&!process.versions["node-webkit"]?(n=require.nodeRequire("fs"),t.get=function(e,t,r){try{var a=n.readFileSync(e,"utf8");0===a.indexOf("\ufeff")&&(a=a.substring(1)),t(a)}catch(o){r(o)}}):"xhr"===m.env||!m.env&&t.createXhr()?t.get=function(e,n,r,a){var o,s=t.createXhr();if(s.open("GET",e,!0),a)for(o in a)a.hasOwnProperty(o)&&s.setRequestHeader(o.toLowerCase(),a[o]);m.onXhr&&m.onXhr(s,e),s.onreadystatechange=function(t){var a,o;4===s.readyState&&(a=s.status,a>399&&600>a?(o=new Error(e+" HTTP status: "+a),o.xhr=s,r(o)):n(s.responseText),m.onXhrComplete&&m.onXhrComplete(s,e))},s.send(null)}:"rhino"===m.env||!m.env&&"undefined"!=typeof Packages&&"undefined"!=typeof java?t.get=function(e,t){var n,r,a="utf-8",o=new java.io.File(e),s=java.lang.System.getProperty("line.separator"),i=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(o),a)),l="";try{for(n=new java.lang.StringBuffer,r=i.readLine(),r&&r.length()&&65279===r.charAt(0)&&(r=r.substring(1)),null!==r&&n.append(r);null!==(r=i.readLine());)n.append(s),n.append(r);l=String(n.toString())}finally{i.close()}t(l)}:("xpconnect"===m.env||!m.env&&"undefined"!=typeof Components&&Components.classes&&Components.interfaces)&&(r=Components.classes,a=Components.interfaces,Components.utils["import"]("resource://gre/modules/FileUtils.jsm"),o="@mozilla.org/windows-registry-key;1"in r,t.get=function(e,t){var n,s,i,l={};o&&(e=e.replace(/\//g,"\\")),i=new FileUtils.File(e);try{n=r["@mozilla.org/network/file-input-stream;1"].createInstance(a.nsIFileInputStream),n.init(i,1,0,!1),s=r["@mozilla.org/intl/converter-input-stream;1"].createInstance(a.nsIConverterInputStream),s.init(n,"utf-8",n.available(),a.nsIConverterInputStream.DEFAULT_REPLACEMENT_CHARACTER),s.readString(n.available(),l),s.close(),n.close(),t(l.value)}catch(c){throw new Error((i&&i.path||"")+": "+c)}}),t}),define("text!lib/Mobile.html",[],function(){return'<div class="phone-wrapper">\n  <div class="phone-container">\n      <div class="phone-inner">\n          <div class="phone-top"></div>\n          <div id="phone-content" class="phone-border">\n          </div>\n          <div class="phone-shadow"></div>\n          <div class="phone-bottom"></div>\n      </div>\n  </div>\n<div>'}),define("lib/UI",["require","exports","module","text!lib/Mobile.html","lib/PostMessageTransport"],function(e,t,n){"use strict";function r(e){var t=y.project("root");R.getDirectoryForPath(t).getContents(function(t,n){return t?e(t):(o()&&(l(),c(),i(),u(),s(),n&&1===n.length&&x.hide()),a(),$("#spinner-container").remove(),$("#main-view").css("visibility","visible"),void e())})}function a(){var e=y.ui("previewMode");if(e)switch(e){case"desktop":m(!0);break;case"mobile":b(!0);break;default:console.warn("[Bramble] unknown preview mode: `"+e+"`")}var t=y.ui("wordWrap");"boolean"==typeof t&&I.set("wordWrap",t);var n=y.ui("autoCloseTags")||{whenOpening:!0,whenClosing:!0,indentTags:[]};I.set("closeTags",n);var r=y.ui("openSVGasXML");"boolean"==typeof r&&I.set("openSVGasXML",r);var a=y.ui("allowJavaScript");"boolean"==typeof a&&I.set("allowJavaScript",a);var o=y.ui("allowWhiteSpace");"boolean"==typeof o&&I.getExtensionPrefs("denniskehrig.ShowWhitespace").set("enabled",o);var s=y.ui("allowAutocomplete");"boolean"==typeof s&&(I.set("codehint.AttrHints",s),I.set("codehint.TagHints",s),I.set("codehint.JSHints",s),I.set("codehint.CssPropHints",s));var i=y.ui("autoUpdate");"boolean"==typeof i&&I.set("autoUpdate",i);var l=y.ui("sidebarWidth");l&&x.resize(l);var c=y.ui("sidebarVisible");null!==c&&(c?x.show():x.hide());var u=y.ui("secondPaneWidth"),d=y.ui("firstPaneWidth");d=100*d/((d?d:0)+(u?u:0)),d&&$("#first-pane").width(d+"%");var p=y.ui("fontSize");p&&/\d+px/.test(p)&&C.setFontSize(p),P.recomputeLayout(!0)}function o(){var e=new w;return e.parse(),"1"!==e.get("ui")}function s(){_.disable()}function i(){$("#working-set-list-second-pane").addClass("hideLeftToolbar"),$("#sidebar .working-set-splitview-btn").remove()}function l(){$("#titlebar").remove(),$("#first-pane .pane-header").remove(),$("#editor-holder").addClass("editor-holder-height"),$("#first-pane .pane-content, .cm-s-light-theme").addClass("first-pane-height")}function c(){M.removeMenu(M.AppMenuBar.FILE_MENU),M.removeMenu(M.AppMenuBar.EDIT_MENU),M.removeMenu(M.AppMenuBar.FIND_MENU),M.removeMenu(M.AppMenuBar.VIEW_MENU),M.removeMenu(M.AppMenuBar.NAVIGATE_MENU),M.removeMenu(M.AppMenuBar.HELP_MENU)}function u(){E.makeResizable("#main-toolbar"),E.hide("#main-toolbar"),$(".content").addClass("hideRightToolbar")}function d(e){e.preventDefault(),L.setActivePaneId("first-pane")}function p(){$("#main-view").addClass("fullscreen-preview")}function f(){$("#main-view").removeClass("fullscreen-preview"),L.setActivePaneId("first-pane"),k.triggerFullscreeDisabled()}function m(e){H&&($("#bramble-iframe-browser").appendTo("#second-pane"),$(".phone-wrapper").detach(),$("#second-pane").removeClass("second-pane-scroll"),$("#second-pane").off("click",d),H=!1,k.triggerPreviewModeChange("desktop"),e||D.reload())}function b(e){H||($("#bramble-iframe-browser").addClass("phone-body"),$("#second-pane").append(U),$("#bramble-iframe-browser").appendTo("#phone-content"),$("#second-pane").addClass("second-pane-scroll"),$("#second-pane").on("click",d),H=!0,k.triggerPreviewModeChange("mobile"),e||D.reload())}function g(){return H?"mobile":"desktop"}function h(e){var t=T.formatBytes(e.size),n=Math.max(Math.min(100*e.percentUsed,100),0).toFixed(2)+"%";x._updateProjectSizeIndicator(t,F,n)}function v(){return B.showModalDialog(A.DIALOG_ID_ERROR,O.ERROR_OUT_OF_SPACE_TITLE,O.ERROR_PROJECT_SIZE_EXCEEDED).getPromise()}var M=brackets.getModule("command/Menus"),E=brackets.getModule("utils/Resizer"),w=brackets.getModule("utils/UrlParams").UrlParams,_=brackets.getModule("widgets/StatusBar"),L=brackets.getModule("view/MainViewManager"),k=brackets.getModule("bramble/BrambleEvents"),y=brackets.getModule("bramble/StartupState"),S=brackets.getModule("command/CommandManager"),R=brackets.getModule("filesystem/FileSystem"),T=brackets.getModule("filesystem/impls/filer/lib/Sizes"),C=brackets.getModule("view/ViewCommandHandlers"),x=brackets.getModule("project/SidebarView"),P=brackets.getModule("view/WorkspaceManager"),I=brackets.getModule("preferences/PreferencesManager"),B=brackets.getModule("widgets/Dialogs"),A=brackets.getModule("widgets/DefaultDialogs"),O=brackets.getModule("strings"),U=(brackets.getModule("utils/StringUtils"),e("text!lib/Mobile.html")),D=e("lib/PostMessageTransport"),H=!1,F=T.formatBytes(T.DEFAULT_PROJECT_SIZE_LIMIT);S.registerInternal("bramble.projectSizeError",v),t.initUI=r,t.showMobileView=b,t.showDesktopView=m,t.enableFullscreenPreview=p,t.disableFullscreenPreview=f,t.getPreviewMode=g,t.removeLeftSideToolBar=i,t.removeMainToolBar=c,t.removeRightSideToolBar=u,t.setProjectSizeInfo=h}),define("lib/Tutorial",["require","exports","module","lib/PostMessageTransport","lib/UI"],function(e,t,n){"use strict";function r(e){u=!!e,"mobile"===M.getPreviewMode()&&(E=!0),u?(d=!0,M.showDesktopView(!0),v.reload()):(E&&(E=!1,M.showMobileView(!0)),p.close().done(p.open)),b.triggerTutorialVisibilityChange(u)}function a(){return u}function o(){return h.join(f.project("root"),"tutorial.html")}function s(e){g.fs().stat(o(),function(t,n){e(n&&"FILE"===n.type)})}function i(){var e=m.getCurrentFullEditor();return e?o()===e.document.file.fullPath:!1}function l(){return d?(d=!1,!0):a()&&i()}function c(){return a()&&i()}var u,d,p=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),f=brackets.getModule("bramble/StartupState"),m=brackets.getModule("editor/EditorManager"),b=brackets.getModule("bramble/BrambleEvents"),g=brackets.getModule("filesystem/impls/filer/BracketsFiler"),h=g.Path,v=e("lib/PostMessageTransport"),M=e("lib/UI"),E=!1;t.setOverride=r,t.getOverride=a,t.getPath=o,t.exists=s,t.shouldReload=l,t.shouldPostMessage=c}),define("lib/launcher",["require","exports","module","lib/Tutorial"],function(e,t,n){"use strict";function r(e){var t,n=e.browser,r=e.server;Object.defineProperty(this,"browser",{configurable:!1,get:function(){return n}}),Object.defineProperty(this,"server",{configurable:!1,get:function(){return r}}),Object.defineProperty(this,"tutorialOverride",{configurable:!1,get:function(){return t},set:function(e){t=e}}),o=this}function a(e,t){var n=o.server,r=o.browser;t=t||function(){},n.serveLiveDocForUrl(e,function(e,n){return e?(console.error("[Launcher Error]",e),t()):(r.update(n),void t())})}var o,s=e("lib/Tutorial");r.prototype.launch=function(e,t){return s.getOverride()?void s.exists(function(e){e?s.shouldReload()&&a(s.getPath(),t):(console.error("[Launcher Error] expected tutorial.html to exist"),s.setOverride(!1))}):a(e,t)},r.getCurrentInstance=function(){return o},n.exports=r}),define("text!lib/PostMessageTransportRemote.js",[],function(){return'// This is a transport injected into the browser via a script that handles the low\n// level communication between the live development protocol handlers on both sides.\n// This transport provides a postMessage mechanism. It\'s injected separately from the\n// protocol handler so that the transport can be changed separately.\n\n(function (global) {\n    "use strict";\n    // In case of detached preview window.opener will refer to editor window\n    var parent = window.opener || window.parent;\n    var postMessageTransport = {\n        /**\n         * @private\n         * An object that contains callbacks to handle various transport events. See `setCallbacks()`.\n         * @type {?{connect: ?function, message: ?function(string), close: ?function}}\n         */\n        _callbacks: null,\n\n        /**\n         * Sets the callbacks that should be called when various transport events occur.\n         */\n        setCallbacks: function (callbacks) {\n            this._callbacks = callbacks;\n        },\n\n        connect: function (url) {\n            var self = this;\n\n            parent.postMessage(JSON.stringify({\n                type: "connect",\n                url: global.location.href\n            }), "*");\n\n            if (self._callbacks && self._callbacks.connect) {\n                self._callbacks.connect();\n            }\n        },\n\n        /**\n         * Sends a message over the transport.\n         * @param {string} msgStr The message to send.\n         * @param {string} data The data object to be shown in console\n         */\n        send: function (msgStr, data) {\n            parent.postMessage(JSON.stringify({\n                type: "message",\n                message: msgStr,\n                data: data\n            }), "*");\n        },\n\n        /**\n         * Establish postMessage connection.\n         */\n        enable: function () {\n            this.connect();\n            var self = this;\n\n            // Listen for message.\n            window.addEventListener("message", function (event) {\n                if (self._callbacks && self._callbacks.message) {\n                    self._callbacks.message(event.data);\n                }\n            });\n        }\n    };\n\n    global._Brackets_LiveDev_Transport = postMessageTransport;\n}(this));\n'}),define("text!lib/MouseManagerRemote.js",[],function(){return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true, bitwise: true */\n/* global addEventListener, removeEventListener, sessionStorage */\n(function(transport) {\n    "use strict";\n\n    var SCROLL_KEY = "___bramble-preview-scrollTop::" + window.___brambleFilename;\n\n    var listening = false;\n\n    function sendHighlightInfo(e) {\n        var x = e.pageX - window.pageXOffset;\n        var y = e.pageY - window.pageYOffset;\n        var elem = document.elementFromPoint(x, y);\n        if(!elem) {\n            return;\n        }\n\n        var ds = elem.dataset;\n        if(!(ds.brambleStartLine && ds.brambleStartCh && ds.brambleEndLine && ds.brambleEndCh)) {\n            return;\n        }\n\n        // If the element has a brackets-id, and this was a click,\n        // use that info to highlight it. Don\'t bother for mousemove.\n        var bracketsId = ds.bracketsId;\n        if(bracketsId) {\n            bracketsId = "," + bracketsId;\n        }\n\n        transport.send("bramble-highlight-lines:" + ds.brambleStartLine + "," +\n            ds.brambleStartCh + "," + ds.brambleEndLine + "," + ds.brambleEndCh + bracketsId);\n    }\n\n    function shouldIgnoreElemEvent(e) {\n        // Ignore mouseout for any inner elements (just for entire window)\n        var from = e.relatedTarget || e.toElement;\n        if(!from || from.nodeName === "HTML") {\n            // Further filter things by only responding to events close to the left/top\n            if(e.clientX <= 32 || e.clientY <= 32) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function startListener() {\n        if(listening) {\n            return;\n        }\n\n        addEventListener("mousemove", sendHighlightInfo, false);\n        listening = true;\n    }\n\n    function stopListener() {\n        if(!listening) {\n            return;\n        }\n\n        removeEventListener("mousemove", sendHighlightInfo, false);\n        listening = false;\n    }\n\n    addEventListener("load", function() {\n        // Restore last scroll position for this session (if any)\n        document.body.scrollTop = sessionStorage.getItem(SCROLL_KEY)|0;\n\n        // Do not listen for mouse events relevant for the inspector\n        // if there is no livedoc\n        if(!transport) {\n            return;\n        }\n\n        startListener();\n\n        // If the user clicks on an element, stop inspecting with mousemove (pin editor)\n        addEventListener("click", function(e) {\n            transport.send("bramble-inspector-disable");\n            stopListener();\n            sendHighlightInfo(e);\n        });\n\n        addEventListener("mouseout", function(e) {\n            if(!shouldIgnoreElemEvent(e)) {\n                // Start listening for user inspecting elements (again)\n                startListener();\n                return false;\n            }\n        });\n\n        // Remember last scroll position for this document\n        addEventListener("scroll", function() {\n            sessionStorage.setItem(SCROLL_KEY, document.body.scrollTop);\n        }, false);\n\n    }, false);\n\n}(window._Brackets_LiveDev_Transport));\n'}),define("lib/MouseManager",["require","exports","module","text!lib/MouseManagerRemote.js","lib/iframe-browser"],function(e,t,n){"use strict";function r(e){var t,n;t=C.getBrowserIframe(),t&&(n=t.contentDocument||t.contentWindow.document,n&&(n.body.style.cursor=e))}function a(){r(x?"pointer":"auto")}function o(){var e=L._getCurrentLiveDoc(),t=e.doc.file.fullPath,n=_.getActiveEditor(),r=n.document.file.fullPath;t!==r&&R.resolve(t,function(e,n){return e?void console.log("[Bramble Error] unable to open path in editor",t,e):void y.execute(S.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath})})}function s(){var e=_.getActiveEditor();return e._codeMirror}function i(){var e=s();g();var t=e.getDoc(),n=t.getCursor("start");e.setCursor(n)}function l(){function e(){var t=s();t.off("focus",e),i()}var t=s();t.on("focus",e)}function c(){x=!0,o(),l(),i(),p(),r("pointer"),w.triggerInspectorChange(!0)}function u(e){x=!1,r("auto"),e?(p(),i()):E=null,w.triggerInspectorChange(!1)}function d(e){if(e!==E){E=e;var t="[data-brackets-id='"+e+"']",n="_LD.highlightRule("+JSON.stringify(t)+")";k.evaluate(n)}}function p(){E=null,k.evaluate("_LD.hideHighlight()")}function f(e){var t=e.match(/^bramble-highlight-lines\:([0-9]+),([0-9]+),([0-9]+),([0-9]+),?([0-9]+)?/);if(t&&t[1]&&t[2]&&t[3]&&t[4])return{startLine:0|t[1],startCh:0|t[2],endLine:0|t[3],endCh:0|t[4],bracketsId:0|t[5]}}function m(e){return!!f(e)}function b(e){return e.match(/^bramble-inspector-disable$/)}function g(){M&&(M.clear(),M=null)}function h(e){if(x){var t=f(e);if(t){var n={line:t.startLine,ch:t.startCh},r={line:t.endLine,ch:t.endCh};g(),t.bracketsId&&d(t.bracketsId);var a=s(),o=a.getScrollInfo().clientHeight/2|0;a.scrollIntoView({from:n,to:r},o),M=a.markText(n,r,{className:"bramble-inspector-highlight"})}}}function v(e){return e=e||"unknown","<script>window.___brambleFilename = '"+e+"';<\/script>\n<script>\n"+T+"<\/script>\n"}var M,E,w=brackets.getModule("bramble/BrambleEvents"),_=brackets.getModule("editor/EditorManager"),L=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),k=brackets.getModule("LiveDevelopment/MultiBrowserImpl/protocol/LiveDevProtocol"),y=brackets.getModule("command/CommandManager"),S=brackets.getModule("command/Commands"),R=brackets.getModule("filesystem/FileSystem"),T=e("text!lib/MouseManagerRemote.js"),C=e("lib/iframe-browser"),x=!1;t.enableInspector=c,t.disableInspector=u,t.isDisableRequest=b,t.getRemoteScript=v,t.highlightLine=h,t.isHighlightLineRequest=m,t.ensurePreviewCursor=a}),define("text!lib/LinkManagerRemote.js",[],function(){return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true, bitwise: true */\n/* global addEventListener, window */\n(function() {\n    "use strict";\n\n    var baseUrl;\n\n    function handleClick(e) {\n        var anchor = e.currentTarget;\n        var url = anchor.getAttribute("href");\n        // Strip base URL if necessary\n        url = url.replace(baseUrl, "");\n        var element;\n\n        // Deal with <a href=""> and ignore\n        if(!(url && url.length)) {\n            return false;\n        }\n\n        // For local paths vs. absolute URLs, try to open the right file.\n        // Special case (i.e., pass through) some common, non-http(s) protocol\n        // schemes so they work as expected.\n        if(/^(javascript|mailto|data|blob):/.test(url)) {\n            return true;\n        }\n\n        var pathNav = !(/\\:?\\/\\//.test(url));\n\n        // Deal with <a href="#"> links (ignore them)\n        var ignoreAnchor = /^\\s*#\\s*$/.test(url);\n\n        // `fragmentId` handles the special case of fragment ids in the\n        // same html page in preview mode (not tutorial mode)\n        var fragmentId = /^\\s*#.+/.test(url);\n\n        if(!ignoreAnchor && fragmentId) {\n            element = document.querySelector(url) || document.getElementsByName(url.slice(1));\n            if(element) {\n                element = element[0] || element;\n                element.scrollIntoView(true);\n            }\n        } else if(pathNav && window._Brackets_LiveDev_Transport) {\n            window._Brackets_LiveDev_Transport.send("bramble-navigate:" + url);\n        } else {\n            window.open(url, "_blank");\n        }\n\n        e.preventDefault();\n    }\n\n    addEventListener("DOMContentLoaded", function init() {\n        // Record base href so we can strip it from absolute URLs to filesystem paths (service worker).\n        var baseElem = document.querySelector("base");\n        baseUrl = baseElem ? baseElem.getAttribute("href") : "";\n\n        // Intercept clicks to <a> in the document.\n        var links = document.links;\n        var len = links.length;\n        var link;\n\n        for(var i=0; i<len; i++) {\n            link = links[i];\n            // Use an existing onclick handler if it exists, or provide our own.\n            link.onclick = (function(userLinkHandler) {\n                return function(event) {\n                    if(userLinkHandler) {\n                        userLinkHandler.call(event.currentTarget, event);\n                    }\n\n                    if(!event.defaultPrevented && event.bubbles) {\n                        handleClick.call(event.currentTarget, event);\n                    }\n                };\n            }(link.onclick));\n        }\n    }, false);\n}());\n'}),define("lib/LinkManager",["require","exports","module","text!lib/LinkManagerRemote.js"],function(e,t,n){"use strict";function r(){return"<script>\n"+p+"<\/script>\n"}function a(e){var t=e.match(/^bramble-navigate\:(.+)/);return t&&t[1]}function o(e){return!!a(e)}function s(e){var t=a(e);if(t){var n=i._getCurrentLiveDoc();if(n){var r=l.dirname(n.doc.file.fullPath);t=l.resolve(r,t),d.resolve(t,function(e,n){return e?void console.log("[Bramble Error] unable to open path in editor",t,e):void c.execute(u.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath})})}}}var i=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),l=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,c=brackets.getModule("command/CommandManager"),u=brackets.getModule("command/Commands"),d=brackets.getModule("filesystem/FileSystem"),p=e("text!lib/LinkManagerRemote.js");t.getRemoteScript=r,t.isNavigationRequest=o,t.navigate=s}),define("text!htmlContent/console.html",[],function(){return'<div id="editor-console" class="bottom-panel vert-resizable top-resizer">\n    <div class="toolbar simple-toolbar-layout mainToolbar">\n        <span class="title">{{CONSOLE_TITLE}}</span>\n        <button id="clearConsole" title="{{CONSOLE_CLEAR_TOOLTIP}}" class="clear-button">{{CONSOLE_CLEAR}}</button>\n        <button title="{{CONSOLE_CLOSE_TOOLTIP}}"href="#" class="close"></button>\n    </div>\n    <div class="console">\n      <div class="helper">\n        <span class="helper-text">{{&CONSOLE_HELPTEXT}}</span>\n      </div>\n    </div>\n</div>\n'}),define("lib/ConsoleInterfaceManager",["require","exports","module","text!htmlContent/console.html"],function(e,t,n){"use strict";function r(){d=0,s.show(),c.removeClass("has-unseen-logs"),$("#editor-holder").addClass("console-open"),s.$panel.find(".console").animate({scrollTop:p[0].scrollHeight},10)}function a(e,t){var n=$("<div class='log-entry "+e+"'></div>");t="object"==typeof t?JSON.stringify(t):""+t,t.length||(t=l.CONSOLE_EMPTY_STRING,n.addClass("empty-string")),n.text(t),s.isVisible()&&n.addClass("new-log"),p.append(n);var r=p.find("div").length;r>f&&p.find(":first-child").remove(),p.animate({scrollTop:p[0].scrollHeight},10)}function o(e,t){s.isVisible()||u||r(),s.isVisible()||d++,d>0&&(c.removeClass("has-unseen-logs").width(c.width()),c.addClass("has-unseen-logs")),t.forEach(function(t){a(e,t)})}var s,i=brackets.getModule("utils/AppInit"),l=(brackets.getModule("view/WorkspaceManager"),brackets.getModule("utils/ExtensionUtils"),brackets.getModule("preferences/PreferencesManager"),e("text!htmlContent/console.html"),brackets.getModule("thirdparty/mustache/mustache"),brackets.getModule("strings")),c=null,u=!1,d=0,p=null,f=30;i.htmlReady(function(){return}),t.add=o}),define("text!lib/ConsoleManagerRemote.js",[],function(){return'(function(transport, console) {\n    "use strict";\n\n    function transportSend(type, args) {\n        var data = {args: args, type: type};\n        transport.send("bramble-console", data);\n    }\n\n    // console namespace\n    var consoleNS = console;\n\n    // Implement standard console.* functions\n    ["log",\n     "warn",\n     "info",\n     "debug",\n     "info",\n     "error",\n     "clear",\n     "time",\n     "timeEnd"].forEach(function(type) {\n        // cache the old binding\n        var oldFn = console[type];\n\n        // rebind for our convenience\n        console[type] = function() {\n            var args = Array.prototype.slice.call(arguments);\n            var data = [];\n\n            // Flatten data to send, deal with Error objects\n            args.forEach(function(arg) {\n                if(arg instanceof Error) {\n                    data.push(arg.message);\n                    data.push(arg.stack);\n                } else {\n                    data.push(arg);\n                }\n            });\n\n            transportSend(type, data);\n\n            // and also fall through to the original function\n            oldFn.apply(consoleNS, arguments);\n        };\n    });\n\n    // Implements global error handler for top-level errors\n    window.addEventListener("error", function(messageOrEvents) {\n        var message = messageOrEvents.message;\n        var error = messageOrEvents.error || {};\n        var stack = error.stack || "Error Interpretting Stack";\n\n        transportSend("error", [ message, stack ]);\n    }, false);\n\n    // cache the old assert binding\n    var oldAssert = console.assert;\n\n    // rebind for our convenience\n    console.assert = function() {\n        var args = Array.prototype.slice.call(arguments);\n        var expr = args.shift();\n\n        if (!expr) {\n            args[0] = "Assertion Failed: " + args[0];\n            transportSend("error", args);\n        }\n\n        // and also fall through to the original function\n        oldAssert.apply(consoleNS, arguments);\n    };\n}(window._Brackets_LiveDev_Transport, window.console));\n'}),define("lib/ConsoleManager",["require","exports","module","lib/ConsoleInterfaceManager","text!lib/ConsoleManagerRemote.js"],function(e,t,n){"use strict";function r(){return"<script>\n"+i+"<\/script>\n"}function a(e){return e.match(/^bramble-console/)}function o(e){var t=e.args,n=e.type||"log";("time"===n||"timeEnd"===n)&&(t[0]=n+": "+t[0]),t&&s.add(n,t)}var s=e("lib/ConsoleInterfaceManager"),i=e("text!lib/ConsoleManagerRemote.js");t.getRemoteScript=r,t.isConsoleRequest=a,t.handleConsoleRequest=o}),define("text!lib/XHRManagerRemote.js",[],function(){
return'/*jslint vars: true, plusplus: true, devel: true, nomen: true, indent: 4, forin: true, maxerr: 50, regexp: true */\n/* global DOMParser */\n(function(global) {\n    "use strict";\n\n    // This script requires access to the transport to send\n    // file requests to the editor as commands\n    var transport = global._Brackets_LiveDev_Transport;\n\n    var XMLHttpRequest = global.XMLHttpRequest;\n    if(!XMLHttpRequest) {\n        console.error("[Brackets LiveDev] XMLHttpRequest not supported in preview");\n        return;\n    }\n\n    function sendMessage(path) {\n        if(!transport) {\n            console.error("[Brackets LiveDev] No transport set");\n            return;\n        }\n\n        transport.send("XMLHttpRequest", path);\n    }\n\n    function nativeXHRFn(xhr, condition, fn, args) {\n        if(condition) {\n            return fn.apply(xhr, args) || true;\n        }\n\n        return null;\n    }\n\n    function XMLHttpRequestLiveDev() {\n        var xhr = new XMLHttpRequest();\n        // Internally store properties normally attached to XHR\n        var _requestUrl;\n        var _abortCalled = false;\n        var _readyState = 0;\n        var _status = 0;\n        var _statusText = "";\n        var _response = "";\n        var _responseText = "";\n        var _responseType;\n        var _onreadystatechange;\n        var _onerror;\n        var _onload;\n        var self = this;\n\n        var $open = xhr.open;\n        // The async parameter for XHRs to the local file system\n        // is ignored as we cannot support synchronous requests\n        // and async is implicit\n        self.open = function(method, url, async, user, password) {\n            if(!(/\\:?\\/\\//.test(url) || /\\s*data\\:/.test(url))) {\n                _requestUrl = url;\n                _abortCalled = false;\n            } else {\n                $open.apply(xhr, arguments);\n            }\n        };\n\n        var $send = xhr.send;\n        self.send = function() {\n            if(!_requestUrl) {\n                $send.apply(xhr, arguments);\n                return;\n            }\n\n            function handleError(data) {\n                _status = data.status || 500;\n                _statusText = data.error || "Internal Server Error";\n                _readyState = 4;\n                data.error = data.error || data;\n\n                if(typeof _onreadystatechange === "function" && !_abortCalled) {\n                    _onreadystatechange.call(self);\n                }\n\n                if(typeof _onerror === "function" && !_abortCalled) {\n                    return _onerror.call(self, {error: data.error});\n                }\n            }\n\n            function setResponse(data) {\n                if(data.error && !_abortCalled) {\n                    return handleError(data);\n                }\n\n                _readyState = 4;\n                _status = 200;\n                _statusText = "OK";\n\n                if(!_responseType || _responseType === "") {\n                    _responseType = "text";\n                }\n\n                switch(_responseType) {\n                case "text":\n                    _response = data.content;\n                    _responseText = _response;\n                    break;\n                case "document":\n                    _response = new DOMParser(data.content, data.mimeType);\n                    _responseText = data.content;\n                    break;\n                case "json":\n                    try {\n                        _response = JSON.parse(data.content);\n                        _responseText = data.content;\n                    } catch(e) {\n                        handleError(e);\n                        return;\n                    }\n                    break;\n                default:\n                    // TODO: We should support arraybuffers and blobs\n                    handleError("Response type of " + _responseType + " is not supported. Response type must be `text`, `document` or `json`.");\n                    return;\n                }\n\n                if(typeof _onreadystatechange === "function" && !_abortCalled) {\n                    _onreadystatechange.call(self);\n                }\n                if(typeof _onload === "function" && !_abortCalled) {\n                    // TODO: deal with addEventListener\n                    _onload.call(self);\n                }\n            }\n\n            window.addEventListener("message", function(event) {\n                var data = event.data;\n\n                try {\n                    data = JSON.parse(data);\n                } catch(e) {\n                    return;\n                }\n\n                if(data.method === "XMLHttpRequest") {\n                    setResponse(data);\n                }\n            });\n\n            sendMessage(_requestUrl);\n\n            _readyState = 1;\n        };\n\n        self.abort = function() {\n            if(!nativeXHRFn(xhr, !_requestUrl, xhr.abort, arguments)) {\n                _abortCalled = true;\n            }\n        };\n\n        self.setRequestHeader = function() {\n            nativeXHRFn(xhr, !_requestUrl, xhr.setRequestHeader, arguments);\n        };\n\n        self.getAllResponseHeaders = function() {\n            return nativeXHRFn(xhr, !_requestUrl, xhr.getAllResponseHeaders, arguments);\n        };\n\n        self.getResponseHeader = function() {\n            return nativeXHRFn(xhr, !_requestUrl, xhr.getResponseHeader, arguments);\n        };\n\n        self.overrideMimeType = function() {\n            nativeXHRFn(xhr, !_requestUrl, xhr.overrideMimeType, arguments);\n        };\n\n        // Hack: allow addEventListener by just adding an onload/onerror functions\n        self.addEventListener = function(event, fn) {\n            if(event === "load") {\n                _onload = fn;\n            } else if(event === "error") {\n                _onerror = fn;\n            }\n        };\n\n        // Expose the properties on the XHR object depending on whether\n        // it is using native XHR or our postmessage XHR\n        Object.defineProperties(self, {\n            "onreadystatechange": {\n                get: function() { return _requestUrl ? _onreadystatechange : xhr.onreadystatechange; },\n                set: function(fn) {\n                    _onreadystatechange = xhr.onreadystatechange = fn;\n                }\n            },\n            "onload": {\n                get: function() { return _requestUrl ? _onload : xhr.onload; },\n                set: function(fn) { _onload = xhr.onload = fn; }\n            },\n            "onerror": {\n                get: function() { return _requestUrl ? _onerror : xhr.onerror; },\n                set: function(fn) { _onerror = xhr.onerror = fn; }\n            },\n            "readyState": {\n                get: function() { return _requestUrl ? _readyState : xhr.readyState; }\n            },\n            "response": {\n                get: function() { return _requestUrl ? _response : xhr.response; }\n            },\n            "responseText": {\n                get: function() { return _requestUrl ? _responseText : xhr.responseText; }\n            },\n            "responseType": {\n                get: function() { return _requestUrl ? _responseType : xhr.responseType; },\n                set: function(value) {\n                    _responseType = xhr.responseType = value;\n                }\n            },\n            "responseXML": {\n                get: function() { return _requestUrl ? null : xhr.responseXML; }\n            },\n            "status": {\n                get: function() { return _requestUrl ? _status : xhr.status; }\n            },\n            "statusText": {\n                get: function() { return _requestUrl ? _statusText : xhr.statusText; }\n            },\n            "timeout": {\n                get: function() { return _requestUrl ? null : xhr.timeout; },\n                set: function(value) {\n                    if(!_requestUrl) { xhr.timeout = value; }\n                }\n            },\n            "ontimeout": {\n                get: function() { return _requestUrl ? null : xhr.ontimeout; },\n                set: function(fn) {\n                    if(!_requestUrl) { xhr.ontimeout = fn; }\n                }\n            },\n            "upload": {\n                get: function() { return _requestUrl ? null : xhr.upload; }\n            },\n            "withCredentials": {\n                get: function() { return _requestUrl ? null : xhr.withCredentials; },\n                set: function(value) {\n                    if(!_requestUrl) { xhr.withCredentials = value; }\n                }\n            }\n        });\n    }\n\n    global.XMLHttpRequest = XMLHttpRequestLiveDev;\n\n}(this));\n'}),define("lib/XHRManager",["require","exports","module","lib/iframe-browser","lib/PostMessageTransport","text!lib/XHRManagerRemote.js"],function(e,t,n){"use strict";function r(){return s.getShouldRewriteUrls()?"<script>\n"+d+"<\/script>\n":""}function a(e){return"XMLHttpRequest"===e}function o(e){var t=c.getBrowserIframe().src,n=s.getFilename(t),r=n!==t?l.dirname(n):n;e=l.resolve(r,l.normalize(e));var a={method:"XMLHttpRequest"};i.readFileAsUTF8(e,function(t,n){t?"ENOENT"===t.code?(a.error="No resource found for `"+e+"`",a.status=404):(a.error="Could not complete the request",a.status=500):a.content=n,u.send(null,JSON.stringify(a))})}var s=brackets.getModule("filesystem/impls/filer/UrlCache"),i=brackets.getModule("filesystem/impls/filer/FilerUtils"),l=i.Path,c=e("lib/iframe-browser"),u=e("lib/PostMessageTransport"),d=e("text!lib/XHRManagerRemote.js");t.getRemoteScript=r,t.isXHRRequest=a,t.handleXHRRequest=o}),define("lib/PostMessageTransport",["require","exports","module","lib/launcher","lib/iframe-browser","text!lib/PostMessageTransportRemote.js","lib/Tutorial","lib/MouseManager","lib/LinkManager","lib/ConsoleManager","lib/XHRManager"],function(e,t,n){"use strict";function r(e){e&&(f=e)}function a(e){if(e){var t=new RegExp('\\"(blob:[^"]+)\\"',"gm"),n=e.replace(t,function(e,t){var n=v.getFilename(t);return['"',n,'"'].join("")});return n}}function o(e){var t;try{t=JSON.parse(e.data)}catch(r){return}if("message"===t.type){if(R.isNavigationRequest(t.message))return void R.navigate(t.message);if(S.isHighlightLineRequest(t.message))return void S.highlightLine(t.message);if(S.isDisableRequest(t.message))return void S.disableInspector();if(C.isXHRRequest(t.message))return void C.handleXHRRequest(t.data);if(t.message&&(t.message=a(t.message)),T.isConsoleRequest(t.message))return void T.handleConsoleRequest(t.data);n.exports.trigger("message",[m,t.message])}else"connect"===t.type&&S.ensurePreviewCursor()}function s(){window.addEventListener("message",o);var e=w.ui("autoUpdate");"boolean"==typeof e&&d(e),M.on("fileRemoved",p),M.on("fileRenamed",p)}function i(e){if(e){var t=h._getCurrentLiveDoc();if(!t)return e;var n=E.dirname(t.doc.file.fullPath),r=new RegExp('(\\\\?\\"?)(href|src|url|value)(\\\\?\\"?\\s?:?\\s?\\(?\\\\?\\"?)([^\\\\"\\),]+)(\\\\?\\"?)',"gm"),a=e.replace(r,function(e,t,r,a,o,s){var i="/"===o.charAt(0)?o:E.join(n,o),l=v.getUrl(i);return o=l===i?o:l,[t,r,a,o,s].join("")});return a}}function l(e,t){var n=f.contentWindow;t=i(t);var r=JSON.parse(t);return"Page.reload"===r.method?void p():"Page.navigate"===r.method?void p(!0):void n.postMessage(t,"*")}function c(e){window.removeEventListener("message",o)}function u(e){var t=h._getCurrentLiveDoc(),n=e||t&&t.doc.file.fullPath,r=k({path:n});return'<base href="'+v.getBaseUrl()+'">\n<script>\n'+y+"<\/script>\n"+C.getRemoteScript()+S.getRemoteScript(r)+R.getRemoteScript()+T.getRemoteScript()}function d(e){L.set("livePreviewAutoReload",e),e&&p(!0)}function p(e){var t,n=b.getCurrentInstance(),r=h._getCurrentLiveDoc();(L.get("livePreviewAutoReload")||e)&&r&&(t=v.getUrl(r.doc.file.fullPath),x!==t&&(x=t,n.launch(t,function(){x=null})))}var f,m=1,b=e("lib/launcher"),g=(e("lib/iframe-browser"),brackets.getModule("utils/EventDispatcher")),h=brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),v=brackets.getModule("filesystem/impls/filer/UrlCache"),M=brackets.getModule("bramble/BrambleEvents"),E=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,w=brackets.getModule("bramble/StartupState"),_=brackets.getModule("thirdparty/mustache/mustache"),L=brackets.getModule("preferences/PreferencesManager"),k=_.compile("{{path}}"),y=e("text!lib/PostMessageTransportRemote.js"),S=(e("lib/Tutorial"),e("lib/MouseManager")),R=e("lib/LinkManager"),T=e("lib/ConsoleManager"),C=e("lib/XHRManager");g.makeEventDispatcher(n.exports);var x;n.exports.getRemoteScript=u,n.exports.setAutoUpdate=d,n.exports.setIframe=r,n.exports.start=s,n.exports.send=l,n.exports.close=c,n.exports.reload=p}),define("lib/compatibility",["require","exports","module"],function(e,t,n){"use strict";var r;t.supportsIFrameHTMLBlobURL=function(e){function t(){clearTimeout(s);try{r=!!o.contentWindow.document.querySelector("#bloburl-test"),document.body.removeChild(o),o=null,URL.revokeObjectURL(a),n=null,a=null}catch(t){r=!1}e(null,r)}if("undefined"!=typeof r)return void e(null,r);var n=new Blob(["<div id='bloburl-test'></div>"],{type:"text/html"}),a=URL.createObjectURL(n),o=document.createElement("iframe");o.style.display="none",document.body.appendChild(o);var s;o.onload=t,o.src=a,s=setTimeout(t,1e3)}}),define("lib/iframe-browser",["require","exports","module","lib/PostMessageTransport","lib/compatibility"],function(e,t,n){"use strict";function r(){if(!i()){var e=d.getLayoutScheme();1===e.rows&&1===e.columns&&o();var t=$("#second-pane").empty(),n={id:"bramble-iframe-browser",frameborder:0};$("<iframe>",n).addClass("iframeWidthHeight").appendTo(t)}}function a(e){e===m?g=m:e===b&&(g=b)}function o(){g===m?u.execute(p.CMD_SPLITVIEW_VERTICAL):g===b&&u.execute(p.CMD_SPLITVIEW_HORIZONTAL),d.setActivePaneId("first-pane")}function s(e){if(e){var t,n=i();h.supportsIFrameHTMLBlobURL(function(r,a){return r?void console.error("[Brackets IFrame-Browser] Unexpected error:",r):void(n&&(a?n.src=e:(t=n.contentWindow.document.open("text/html","replace"),t.write(e),t.close())))})}}function i(){return window.document.getElementById("bramble-iframe-browser")}function l(){f.hide("#second-pane"),$("#first-pane").addClass("expandEditor")}function c(){f.show("#second-pane"),$("#first-pane").removeClass("expandEditor")}var u=brackets.getModule("command/CommandManager"),d=brackets.getModule("view/MainViewManager"),p=brackets.getModule("command/Commands"),f=brackets.getModule("utils/Resizer"),m=(brackets.getModule("widgets/StatusBar"),0),b=1,g=m,h=(e("lib/PostMessageTransport"),e("lib/compatibility"));t.init=r,t.update=s,t.setLayout=o,t.getBrowserIframe=i,t.HORIZONTAL_ORIENTATION=b,t.VERTICAL_ORIENTATION=m,t.setOrientation=a,t.show=c,t.hide=l}),define("nohost/HTMLServer",["require","exports","module","lib/compatibility","lib/MouseManager","lib/PostMessageTransport","lib/LinkManager"],function(e,t,n){"use strict";function r(e){return l.isStaticHtmlFileExt(e)}function a(e){return c.isCSS(p.extname(e))}function o(e){e=e||{},i.call(this,e)}var s,i=brackets.getModule("LiveDevelopment/Servers/BaseServer").BaseServer,l=brackets.getModule("LiveDevelopment/LiveDevelopmentUtils"),c=brackets.getModule("filesystem/impls/filer/lib/content"),u=brackets.getModule("filesystem/impls/filer/UrlCache"),d=brackets.getModule("filesystem/impls/filer/FilerUtils"),p=d.Path,f=brackets.getModule("filesystem/impls/filer/lib/HTMLRewriter"),m=brackets.getModule("filesystem/impls/filer/lib/CSSRewriter"),b=e("lib/compatibility"),g=(e("lib/MouseManager"),e("lib/PostMessageTransport"));e("lib/LinkManager");o.prototype=Object.create(i.prototype),o.prototype.constructor=o,o.prototype.pathToUrl=function(e){return u.getUrl(e)},o.prototype.urlToPath=function(e){return u.getFilename(e)},o.prototype.readyToServe=function(){var e=new $.Deferred;return b.supportsIFrameHTMLBlobURL(function(t,n){t&&(console.error("[Brackets HTMLServer] Unexpected error:",t),e.reject()),s=n,e.resolve()}),e.promise()},o.prototype.canServe=function(e){return e===this._pathResolver(e)?!1:e.match(/\/$/)?!0:r(e)},o.prototype.add=function(e){e.setInstrumentationEnabled&&e.setInstrumentationEnabled(!0),i.prototype.add.call(this,e)},o.prototype.serveLiveDocForUrl=function(e,t){var n=u.getFilename(e);this.serveLiveDocForPath(n,t)},o.prototype.serveLiveDocForPath=function(e,t){function n(e,t,n){m.rewrite(e,t,function(t,r){return t?void n(t):void u.createURL(e,r,"text/css",n)})}function o(e,t,n,r){f.rewrite(e,t,n,function(t,n){return t?void r(t):void u.createURL(e,n,"text/html",function(e,t){return e&&r(e),c.isBlobURL(t)&&!s?void r(null,n):void r(null,t)})})}function i(s){r(e)?o(e,s,l,t):a(e)?n(e,s,t):t(new Error("[Brackets HTMLServer] expected .html or .css live doc type:"+e))}var l=this,p=this.get(e);return p?i(p.getResponseData().body):void d.readFileAsUTF8(e).fail(t).done(function(t){if(!r(e))return i(t);var n=g.getRemoteScript(e),a=n+"$&",o=new RegExp(/<\/\s*head>/),s=new RegExp(/<\/\s*html>/);o.test(t)?t=t.replace(o,a):s.test(t)?t=t.replace(s,a):t+=n,i(t)})},t.HTMLServer=o}),define("nohost/main",["require","exports","module","nohost/HTMLServer"],function(e,t,n){"use strict";function r(){return o||(o=new l({pathResolver:i.makeProjectRelativeIfPossible,root:i.getProjectRoot()})),o}function a(){s.registerServer({create:r},9001)}var o,s=brackets.getModule("LiveDevelopment/LiveDevServerManager"),i=brackets.getModule("project/ProjectManager"),l=e("nohost/HTMLServer").HTMLServer;t.init=a,t.getHTMLServer=r}),define("lib/BrambleCodeSnippets",["require","exports","module"],function(e,t,n){"use strict";function r(){function e(e){s.focusActivePane();var t=o.getActiveEditor();if(t){var n=t.getCursorPos();t.document.replaceRange(e,n,null,"paste")}}a.registerInternal(i,e)}var a=brackets.getModule("command/CommandManager"),o=brackets.getModule("editor/EditorManager"),s=brackets.getModule("view/MainViewManager"),i="bramble.addCodeSnippet";t.init=r}),define("lib/SVGUtils",["require","exports","module"],function(e,t,n){"use strict";function r(e){var t=new $.Deferred;return e.isDirty?(u.get(c.FILE_SAVE).execute({doc:e}).then(t.resolve,t.reject),t.promise()):t.resolve().promise()}function a(e){return u.get(c.FILE_CLOSE).execute({file:e,_closeOptions:{noOpenNextFile:!0}})}function o(e){return u.get(c.FILE_OPEN).execute({fullPath:e.fullPath})}function s(e,t){return a(e).done(function(){o(e).then(t.resolve,t.reject)}).fail(t.reject),t.promise()}function i(e){var t=new $.Deferred,n=p.getOpenDocumentForPath(e.fullPath);return n?(r(n).done(function(){s(e,t)}).fail(t.reject),t.promise()):s(e,t)}function l(e){var t=d.getAllOpenFiles().filter(function(e){var t=e.fullPath;return".svg"===b.extname(t).toLowerCase()});m.doSequentially(t,i,!1).then(e)}var c=brackets.getModule("command/Commands"),u=brackets.getModule("command/CommandManager"),d=brackets.getModule("view/MainViewManager"),p=brackets.getModule("document/DocumentManager"),f=brackets.getModule("preferences/PreferencesManager"),m=brackets.getModule("utils/Async"),b=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path;f.definePreference("openSVGasXML","boolean",!1),t.showXML=function(e){f.set("openSVGasXML",!0),l(e)},t.showImage=function(e){f.set("openSVGasXML",!1),l(e)}}),define("lib/Theme",["require","exports","module"],function(e,t,n){"use strict";function r(e){return"production"===brackets.env?e.replace(".less",".css"):e}function a(e){var t=e.theme||s();o("light-theme"===t?"dark-theme":"light-theme")}function o(e){c.set("theme",e),m.triggerThemeChange(e)}function s(){return c.get("theme")}function i(e){var t={name:r("main.less"),_path:u.join(f,r("lightTheme.less"))},n={name:"light-theme"},a={name:r("main.less"),_path:u.join(f,r("darkTheme.less"))},o={name:"dark-theme",theme:{dark:!0}};l.addTheme(t,n),l.addTheme(a,o),"light-theme"!==e&&"dark-theme"!==e&&(e="dark-theme"),c.set("theme",e)}var l=brackets.getModule("view/ThemeManager"),c=brackets.getModule("preferences/PreferencesManager").getExtensionPrefs("themes"),u=brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,d=brackets.getModule("thirdparty/path-utils/path-utils"),p=d.directory(window.location.href),f=u.join(p,"extensions/default/bramble/stylesheets"),m=brackets.getModule("bramble/BrambleEvents");n.exports.toggle=a,n.exports.setTheme=o,n.exports.getTheme=s,n.exports.init=i}),define("lib/RemoteCommandHandler",["require","exports","module","lib/SVGUtils","lib/MouseManager","lib/PostMessageTransport","lib/Tutorial","lib/Theme","lib/UI","lib/iframe-browser"],function(e,t,n){"use strict";function r(e){return function(){var t={type:"bramble:remoteCommand:callback",callback:e};parent.postMessage(JSON.stringify(t),"*")}}function a(e,t,n){function r(){t.unshift(c[e]),i.execute.apply(null,t).always(n)}switch("FILE_FOLDER"===e&&(e="FILE_NEW_FOLDER"),e){case"EDIT_UNDO":case"EDIT_REDO":case"VIEW_INCREASE_FONT_SIZE":case"VIEW_DECREASE_FONT_SIZE":case"VIEW_RESTORE_FONT_SIZE":var a=l.getActiveEditor();a&&!a.hasFocus()?(a.one("focus",r),a.focus()):r();break;default:r()}}function o(e,t,n){var r=!1;switch(e){case"BRAMBLE_RELOAD":u.forceScriptsOnce(),_.reload(!0);break;case"BRAMBLE_MOBILE_PREVIEW":y.showMobileView();break;case"BRAMBLE_DESKTOP_PREVIEW":y.showDesktopView();break;case"BRAMBLE_ENABLE_FULLSCREEN_PREVIEW":y.enableFullscreenPreview();break;case"BRAMBLE_DISABLE_FULLSCREEN_PREVIEW":y.disableFullscreenPreview();break;case"BRAMBLE_ENABLE_AUTO_UPDATE":g.set("autoUpdate",!0),_.setAutoUpdate(!0);break;case"BRAMBLE_DISABLE_AUTO_UPDATE":g.set("autoUpdate",!1),_.setAutoUpdate(!1);break;case"BRAMBLE_ENABLE_SCRIPTS":g.set("allowJavaScript",!0),_.reload();break;case"BRAMBLE_DISABLE_SCRIPTS":g.set("allowJavaScript",!1),_.reload();break;case"BRAMBLE_ENABLE_WHITESPACE":g.getExtensionPrefs("denniskehrig.ShowWhitespace").set("enabled",!0);break;case"BRAMBLE_DISABLE_WHITESPACE":g.getExtensionPrefs("denniskehrig.ShowWhitespace").set("enabled",!1);break;case"BRAMBLE_ENABLE_INSPECTOR":w.enableInspector();break;case"BRAMBLE_ENABLE_AUTOCOMPLETE":g.set("codehint.TagHints",!0),g.set("codehint.AttrHints",!0),g.set("codehint.JSHints",!0),g.set("codehint.CssPropHints",!0);break;case"BRAMBLE_DISABLE_AUTOCOMPLETE":g.set("codehint.TagHints",!1),g.set("codehint.AttrHints",!1),g.set("codehint.JSHints",!1),g.set("codehint.CssPropHints",!1);break;case"BRAMBLE_DISABLE_INSPECTOR":w.disableInspector(!0);break;case"BRAMBLE_LIGHT_THEME":k.setTheme("light-theme");break;case"BRAMBLE_DARK_THEME":k.setTheme("dark-theme");break;case"BRAMBLE_SHOW_SIDEBAR":d.show();break;case"BRAMBLE_HIDE_SIDEBAR":d.hide();break;case"BRAMBLE_SHOW_PREVIEW":S.show();break;case"BRAMBLE_HIDE_PREVIEW":S.hide();break;case"BRAMBLE_HIDE_STATUSBAR":p.disable();break;case"BRAMBLE_SHOW_STATUSBAR":p.enable();break;case"BRAMBLE_ENABLE_WORD_WRAP":g.set("wordWrap",!0);break;case"BRAMBLE_DISABLE_WORD_WRAP":g.set("wordWrap",!1);break;case"BRAMBLE_CONFIGURE_AUTO_CLOSE_TAGS":g.set("closeTags",t[0]);break;case"BRAMBLE_OPEN_SVG_AS_XML":r=!0,E.showXML(n);break;case"BRAMBLE_OPEN_SVG_AS_IMAGE":r=!0,E.showImage(n);break;case"BRAMBLE_SHOW_TUTORIAL":L.setOverride(!0);break;case"BRAMBLE_HIDE_TUTORIAL":L.setOverride(!1);break;case"BRAMBLE_SHOW_UPLOAD_FILES_DIALOG":r=!0,i.execute("bramble.showUploadFiles").always(n);break;case"BRAMBLE_ADD_NEW_FILE":r=!0,M.getEnforceLimits()?i.execute("bramble.projectSizeError").always(n):i.execute("bramble.addFile",t[0]).always(n);break;case"BRAMBLE_EXPORT":r=!0,v.archive(b.project("root"),n);break;case"RESIZE":f.recomputeLayout(!0),m.triggerUpdateLayoutEnd();break;case"BRAMBLE_ADD_CODE_SNIPPET":r=!0,i.execute("bramble.addCodeSnippet",t[0]).always(n);break;case"BRAMBLE_ENABLE_PROJECT_CAPACITY_LIMITS":r=!0,M.setEnforceLimits(!0),i.execute("bramble.projectSizeError").always(n);break;case"BRAMBLE_DISABLE_PROJECT_CAPACITY_LIMITS":M.setEnforceLimits(!1);break;case"BRAMBLE_PROJECT_SIZE_CHANGE":y.setProjectSizeInfo(t[0]);break;default:console.log("[Bramble] unknown command:",e),r=!0}r||n()}function s(e){var t;try{t=JSON.parse(e.data)}catch(n){return}if("bramble:remoteCommand"===t.type){var s=t.args;switch(h.isArray(s)||(s=[s]),t.commandCategory){case"brackets":a(t.command,s,r(t.callback));break;case"bramble":o(t.command,s,r(t.callback));break;default:console.error("[Bramble] unknown remote command request:",t)}}}var i=brackets.getModule("command/CommandManager"),l=brackets.getModule("editor/EditorManager"),c=brackets.getModule("command/Commands"),u=(brackets.getModule("filesystem/FileSystem"),brackets.getModule("filesystem/impls/filer/lib/HTMLRewriter")),d=brackets.getModule("project/SidebarView"),p=brackets.getModule("widgets/StatusBar"),f=brackets.getModule("view/WorkspaceManager"),m=brackets.getModule("bramble/BrambleEvents"),b=brackets.getModule("bramble/StartupState"),g=brackets.getModule("preferences/PreferencesManager"),h=brackets.getModule("thirdparty/lodash"),v=brackets.getModule("filesystem/impls/filer/ArchiveUtils"),M=brackets.getModule("filesystem/impls/filer/lib/Sizes"),E=e("lib/SVGUtils"),w=e("lib/MouseManager"),_=e("lib/PostMessageTransport"),L=e("lib/Tutorial"),k=e("lib/Theme"),y=e("lib/UI"),S=e("lib/iframe-browser");t.handleRequest=s}),define("lib/RemoteEvents",["require","exports","module","lib/UI","lib/Theme"],function(e,t,n){"use strict";function r(e){parent.postMessage(JSON.stringify(e),"*")}function a(){var e=$("#first-pane"),t=$("#second-pane"),n=$("#sidebar");r({type:"bramble:layout",sidebarWidth:n.is(":visible")?n.width():0,firstPaneWidth:e?e.width():0,secondPaneWidth:t?t.width():0})}function o(e,t){r({type:"bramble:activeEditorChange",fullPath:e,filename:t})}function s(){l.on("bramble:updateLayoutStart",a),l.on("bramble:updateLayoutEnd",a),l.on("bramble:previewModeChange",function(e,t){r({type:"bramble:previewModeChange",mode:t})}),l.on("bramble:sidebarChange",function(e,t){r({type:"bramble:sidebarChange",visible:t})}),l.on("bramble:dialogOpened",function(e){r({type:"bramble:dialogOpened"})}),l.on("bramble:dialogClosed",function(e){r({type:"bramble:dialogClosed"})}),l.on("bramble:projectDirty",function(e,t){r({type:"bramble:projectDirty",path:t})}),l.on("bramble:projectSaved",function(e){r({type:"bramble:projectSaved"})});var e;c.on("currentFileChange",function(t,n){if(!n)return e="",void o("","");var r=n.fullPath,a=d.basename(r);r!==e&&(e=r,o(r,a))}),l.on("fileRenamed",function(t,n,r){if(n===e){var a=r,s=d.basename(a);e=a,o(a,s)}}),l.on("bramble:themeChange",function(e,t){r({type:"bramble:themeChange",theme:t})}),l.on("bramble:tutorialVisibilityChange",function(e,t){r({type:"bramble:tutorialVisibilityChange",visible:t})}),l.on("bramble:inspectorChange",function(e,t){r({type:"bramble:inspectorChange",enabled:t})}),u.on("fontSizeChange",function(e,t){r({type:"bramble:fontSizeChange",fontSize:t})}),p.on("change","wordWrap",function(){r({type:"bramble:wordWrapChange",wordWrap:p.get("wordWrap")})}),p.on("change","closeTags",function(){r({type:"bramble:autoCloseTagsChange",autoCloseTags:p.get("closeTags")})}),p.on("change","allowJavaScript",function(){r({type:"bramble:allowJavaScriptChange",allowJavaScript:p.get("allowJavaScript")})});var t=p.getExtensionPrefs("denniskehrig.ShowWhitespace");t.on("change",function(e,n){-1!==n.ids.indexOf("enabled")&&r({type:"bramble:allowWhiteSpaceChange",allowWhiteSpace:t.get("enabled")})}),p.on("change","codehint.TagHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.TagHints")})}),p.on("change","codehint.AttrHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.AttrHints")})}),p.on("change","codehint.JSHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.JSHints")})}),p.on("change","codehint.CssPropHints",function(){r({type:"bramble:autocompleteChange",value:p.get("codehint.CssPropHints")})}),p.on("change","autoUpdate",function(){r({type:"bramble:autoUpdateChange",autoUpdate:p.get("autoUpdate")})}),p.on("change","openSVGasXML",function(){r({type:"bramble:openSVGasXMLChange",openSVGasXML:p.get("openSVGasXML")})})}function i(){var e=c.getCurrentlyViewedFile(),t="",n="";e&&(t=e.fullPath,n=d.basename(t));var a=$("#first-pane"),o=$("#second-pane"),s=$("#sidebar");r({type:"bramble:loaded",sidebarVisible:s.is(":visible"),sidebarWidth:s.is(":visible")?s.width():0,firstPaneWidth:a?a.width():0,secondPaneWidth:o?o.width():0,fullPath:t,filename:n,previewMode:f.getPreviewMode(),fontSize:u.getFontSize(),theme:m.getTheme(),wordWrap:p.get("wordWrap"),autoCloseTags:p.get("closeTags"),autoUpdate:p.get("autoUpdate"),openSVGasXML:p.get("openSVGasXML"),allowJavaScript:p.get("allowJavaScript"),allowWhiteSpace:p.getExtensionPrefs("denniskehrig.ShowWhitespace").get("enabled")})}var l=brackets.getModule("bramble/BrambleEvents"),c=brackets.getModule("view/MainViewManager"),u=brackets.getModule("view/ViewCommandHandlers"),d=brackets.getModule("filesystem/impls/filer/FilerUtils").Path,p=brackets.getModule("preferences/PreferencesManager"),f=e("lib/UI"),m=e("lib/Theme");t.start=s,t.loaded=i}),define("main",["require","exports","module","lib/iframe-browser","lib/UI","lib/launcher","nohost/main","lib/BrambleCodeSnippets","lib/PostMessageTransport","lib/RemoteCommandHandler","lib/RemoteEvents","lib/Theme"],function(e,t,n){"use strict";function r(e){try{return e=JSON.parse(e||null),e||{}}catch(t){return!1}}function a(e){e&&console.warn("Unable to preload filesystem URLs",e),c.set("insertHintOnTab",!0),c.set("spaceUnits",2),c.set("tabSize",2),c.setViewState("splitview.multipane-info",!0),E.loaded()}function o(e){v.init(function(t){return t?void console.error("[Bramble] unable to initialize URL cache",t):void h.refresh(function(t){t&&console.warn("[Bramble] unable to preload all filesystem Blob URLs",t),e()})})}function s(){var e=u.project("root"),t=u.project("filename");d.openProject(e).always(function(){var e=new $.Deferred;m.resolve(t,function(t,n){if(t)e.reject();else{var r=p.execute(f.CMD_ADD_TO_WORKINGSET_AND_OPEN,{fullPath:n.fullPath});r.then(e.resolve,e.reject)}}),e.always(function(){l._dispatchReady(l.APP_READY),b.initUI(a)})})}function i(e){var t=r(e.data);t&&"bramble:init"===t.type&&(window.removeEventListener("message",i,!1),window.addEventListener("message",M.handleRequest,!1),u.project.init({root:t.mount.root,filename:t.mount.filename,zipFilenamePrefix:t.state.zipFilenamePrefix||"thimble-project"}),u.ui.init({fontSize:t.state.fontSize,theme:t.state.theme,sidebarVisible:t.state.sidebarVisible,sidebarWidth:t.state.sidebarWidth,firstPaneWidth:t.state.firstPaneWidth,secondPaneWidth:t.state.secondPaneWidth,previewMode:t.state.previewMode,wordWrap:t.state.wordWrap,allowAutocomplete:t.state.allowAutocomplete,autoCloseTags:t.state.autoCloseTags,autoUpdate:t.state.autoUpdate,openSVGasXML:t.state.openSVGasXML,allowJavaScript:t.state.allowJavaScript,allowWhiteSpace:t.state.allowWhiteSpace}),w.init(u.ui("theme")),E.start(),o(s))}var l=brackets.getModule("utils/AppInit"),c=brackets.getModule("preferences/PreferencesManager"),u=(brackets.getModule("LiveDevelopment/LiveDevMultiBrowser"),brackets.getModule("bramble/StartupState")),d=brackets.getModule("project/ProjectManager"),p=brackets.getModule("command/CommandManager"),f=brackets.getModule("command/Commands"),m=brackets.getModule("filesystem/FileSystem"),b=(e("lib/iframe-browser"),e("lib/UI")),g=(e("lib/launcher"),e("nohost/main"),e("lib/BrambleCodeSnippets"),brackets.getModule("utils/ExtensionUtils")),h=(e("lib/PostMessageTransport"),brackets.getModule("filesystem/impls/filer/BracketsFiler").Path,brackets.getModule("filesystem/impls/filer/FileSystemCache")),v=brackets.getModule("filesystem/impls/filer/UrlCache"),M=e("lib/RemoteCommandHandler"),E=e("lib/RemoteEvents"),w=e("lib/Theme");g.loadStyleSheet(n,"stylesheets/style.less"),window.addEventListener("message",i,!1),window.parent.postMessage(JSON.stringify({type:"bramble:readyToMount"}),"*")});